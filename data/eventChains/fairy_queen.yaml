# Fairy Queen Quest - Visit the Fairy Queen in the ancient oak
#
# Players befriend Morgan and/or Stella by growing fairy bluebells
# and talking to the fairies at night. When reaching Good Friends
# status, they receive the Fairy Form Potion and can visit the
# Fairy Queen inside the Giant Fairy Oak.
#
# After the midnight cutscene, Celestia tells the player she cannot
# grant magic abilities (they're human), but directs them to Althea
# to ask about her sister. She also promises fairy form potions on
# future midnight visits.
#
# Fairy meeting, potion management, and oak visit tracking are
# handled by the TypeScript handler in data/questHandlers/fairyQueenHandler.ts

id: fairy_queen
title: Visit the Fairy Queen
description: Befriend the fairies and earn the privilege of visiting the Fairy Queen in the ancient oak.
type: discovery

trigger:
  type: manual  # Started when first meeting Morgan or Stella

stages:
  - id: met_fairy
    stageNumber: 1
    text: >
      You've met a fairy attracted to your fairy bluebells!
      Build your friendship to learn their secrets.
    dialogue:
      village_elder:
        text: "Fairies, you say? My grandmother used to tell stories about them. Be kind to them!"
        expression: thinky

  - id: received_potion
    stageNumber: 2
    text: >
      Your fairy friend trusts you enough to share a secret -
      the Fairy Form Potion! Use it to visit the Fairy Queen.
    rewards:
      - item: potion_fairy_form
        quantity: 1
    event:
      title: Fairy Form Potion received
      description: earned the trust of a fairy and received the magical Fairy Form Potion
      contributor: A true friend of fairies

  - id: visited_queen
    stageNumber: 3
    text: >
      You've met Queen Celestia beneath the ancient oak at midnight.
      She has named you an honorary fairy, but cannot grant you magic â€”
      you are human, after all. She suggests you speak to the old woman
      in the village about her sister. Visit Celestia again at midnight
      for a fairy form potion.
    event:
      title: Audience with the Fairy Queen
      description: met Queen Celestia and was named an honorary fairy
      contributor: An honorary fairy
    dialogue:
      althea:
        text: "*She glances up from her knitting with a curious look.* You seem different today, dearie. Like you've seen something magical."
        expression: thinky

  - id: complete
    stageNumber: 4
    text: >
      Quest complete! You've experienced the magic of the fairy realm
      and earned the title of Honorary Fairy.
    event:
      title: Honorary Fairy
      description: completed the fairy quest and was named an honorary fairy
      contributor: A fairy friend
    end: true
